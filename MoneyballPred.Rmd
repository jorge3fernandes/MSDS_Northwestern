---
title: "Moneyball"
output: html_notebook
---

List of Packages used;  
 - caret  
 - corrplot  
 - dplyr  
 - missForest  
```{r}
library(caret)
library(corrplot)
library(dplyr)
library(missForest) # will be used to impute missing values
```


```{r}
# browse to the data
moneyball = read.csv('/Users/legs_jorge/Documents/Data Science Projects/MSDS_Northwestern/MSDS 411/Unit 01 Moneyball Baseball Problem/Data/moneyball.csv', header = T)
```

Let's do a quick analysis to understand the distribution Null values accross our dataset. Here, we count the number of NAs and divide it by the number of rows to get a per columns percentage of NAs.
```{r}
#let check for NAs in the data
#Counting the number of NAs per column and check the percentage of NAs per column
NAPerc <- sapply(moneyball, function(x) (sum(is.na(x))/length(x))*100) %>%
  data.frame()
NAPerc$Column <- rownames(NAPerc)
colnames(NAPerc) <- c("NA_Perc", "Col_Name")
NAPerc
```

Let's focus only on columns with missing values.
```{r}
subset(NAPerc,NA_Perc > 0) %>% arrange(desc(NA_Perc))

```


Looks like we will be deleting the TEAM_BATTING_HPB, But first I need to understand why it's missing. After doing some reading it looks like that columns could be translated to a 0 or 1. I need to do more investigating.
From working experience, usually columns with high volumes of NAs indicates important informations, simply because they could be capturing rare instance where a process fails. Instead of deleting it, I will try to see if I can transform it into a categorical variable with 1s and 0s. Now, regarding the other one, I will try some other inputation methods such as KNN, mean, median, etc.
[Here](https://www.r-bloggers.com/imputing-missing-data-with-r-mice-package/) is a great article from Rblogger that discusses the package [MICE](https://cran.r-project.org/web/packages/mice/mice.pdf).



### Let the Inputation begin
Before we start the imputation, let's try to understand why we have missing data. 

**There are two types of missing data**
 - MCAR: missing completely at random. This is the desirable scenario in case of missing data.
 - MNAR: missing not at random. Missing not at random data is a more serious issue and in this case it might be wise to check the data gathering process further and try to understand why the information is missing. For instance, if most of the people in a survey did not answer a certain question, why did they do that? Was the question unclear?

It would be good to understand exactly what type of missing value we are dealing with.
```{r}
moneyball[is.na(moneyball) == TRUE] <- 0
mball_cor <- cor(moneyball)
corrplot(mball_cor, method="number")


# Correlation panel
panel.cor <- function(x, y){
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(0, 1, 0, 1))
    r <- round(cor(x, y), digits=2)
    txt <- paste0("R = ", r)
    cex.cor <- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
  points(x,y, pch = 19)
}
# Create the plots
pairs(moneyball, 
      lower.panel = panel.cor,
      upper.panel = upper.panel)
```





